SET client_min_messages=ERROR;
CREATE EXTENSION multicorn CASCADE;
CREATE server multicorn_srv foreign data wrapper multicorn options (
    wrapper 'multicorn.testfdw.TestForeignDataWrapper'
);
CREATE user mapping FOR current_user server multicorn_srv options (usermapping 'test');
CREATE foreign table testmulticorn (
    test1 character varying options (prefix 'test'),
    test2 character varying
) server multicorn_srv options (
    option1 'option1'
);
select * from testmulticorn limit 1;
   test1   |   test2   
-----------+-----------
 test1 1 0 | test2 2 0
(1 row)

ALTER foreign table testmulticorn alter test1 options (set prefix 'test2');
select * from testmulticorn limit 1;
   test1   |   test2   
-----------+-----------
 test1 1 0 | test2 2 0
(1 row)

ALTER foreign table testmulticorn alter test1 options (drop prefix);
select * from testmulticorn limit 1;
   test1   |   test2 
-----------+-----------
 test1 1 0 | test2 2 0
(1 row)

ALTER foreign table testmulticorn alter test1 options (add prefix 'test3');
select * from testmulticorn limit 1;
   test1   |   test2   
-----------+-----------
 test1 1 0 | test2 2 0
(1 row)

DROP USER MAPPING FOR current_user SERVER multicorn_srv;
DROP EXTENSION multicorn cascade;
drop cascades to foreign table testmulticorn
